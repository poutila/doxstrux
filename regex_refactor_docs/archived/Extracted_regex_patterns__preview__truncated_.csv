file,pattern
markdown_parser_core.py,"style\s*=\s*[""\'][^""\']*(url\s*\(\s*javascript:|expression\s*\()', re.I\n    )\n    _META_REFRESH_PAT = re.compile("
markdown_parser_core.py,"<(iframe|object|embed)[^>]*>"", re.I)  # Any frame-like element\n\n    # BiDi control characters for detecting text direction manipulation\n    _BIDI_CONTROLS = [\n        ""\u202a"",  # Left-to-Right Em"
markdown_parser_core.py,"<[^>]+>"", """", html)\n        # Allow safe subset\n        if HAS_BLEACH:\n            return bleach.clean(\n                html,\n                tags=self._ALLOWED_HTML_TAGS,\n                attrib"
markdown_parser_core.py,"\bon\w+\s*=\s*[\""'][^\""']*[\""']"", """", html, flags=re.IGNORECASE)\n        html = re.sub("
markdown_parser_core.py,"<\s*script\b"", text, re.I):\n                reasons.append(""script_tag_removed"")\n            text = re.sub("
markdown_parser_core.py,"\bon[a-z]+\s*="", text, re.I):\n                reasons.append(""event_handlers_removed"")\n            text = re.sub("
markdown_parser_core.py,"<\w+[^>]*>"", text):\n                reasons.append(""html_stripped"")\n            text = self._sanitize_html_content(text, allows_html=False)\n        elif cfg[""allows_html""]:\n            # Sanitize "
markdown_parser_core.py,"(?<!\!)\[([^\]]+)\]\(([^)]+)\)"", _strip_bad_link, text)\n            if removed_schemes:\n                reasons.append(""disallowed_link_schemes_removed"")\n\n        # 5) Data-URI images: drop or bud"
markdown_parser_core.py,"<(div|span|script|style|iframe|object|embed|form)[\s>]"", raw_content, re.IGNORECASE\n        ):\n            security[""statistics""][""has_html_block""] = True\n        if re.search("
markdown_parser_core.py,"<script[\s>]"", raw_content, re.IGNORECASE):\n            security[""statistics""][""has_script""] = True\n            security[""warnings""].append(\n                {""type"": ""script_tag"", ""line"": None, ""me"
markdown_parser_core.py,"^data:([^;,]+)?(;base64)?,(.*)$"", uri)\n        if not match:\n            return {}\n\n        media_type = match.group(1) or ""text/plain""\n        is_base64 = bool(match.group(2))\n        data = ma"
markdown_parser_core.py,"<(\w+)"", html_content)\n        return list(set(tags))  # Deduplicate\n\n    def _build_mappings(self) -> dict[str, Any]:\n        """"""Build line-to-content mappings.\n\n        Build line-type map and"
markdown_parser_core.py,"-{3,}"", line):\n                # Heuristic: a separator row should mostly be pipes/dashes/colons/spaces\n                if re.fullmatch("
markdown_parser_core.py,"^[a-z]:[/\\]"", decoded_lower):\n            return True\n\n        for pattern in patterns:\n            if pattern in decoded_lower:\n                return True\n\n        # Normalize path and check"
markdown_parser_core.py,"[\u0400-\u04FF]"", text_sample))\n                has_greek = bool(re.search("
markdown_parser_core.py,"[\u0600-\u06FF]"", text_sample))\n                has_hebrew = bool(re.search("
markdown_parser_core.py,"[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF]"", text_sample))\n\n                script_count = sum(\n                    [has_latin, has_cyrillic, has_greek, has_arabic, has_hebrew, has_cjk]\n           "
markdown_parser_core.py,"(system|prompt|instruction|ignore|override)"", content, re.IGNORECASE\n                ):\n                    return True\n\n        return False\n\n    def _slugify_base(self, text: str) -> str:\n   "
markdown_parser_core.py,"[^\w-]"", """", s).strip()\n        # Clean up multiple hyphens\n        s = re.sub("
markdown_parser_core.py,"[\s/]+"", ""-"", s)\n        # Then remove other non-word characters (but keep hyphens)\n        s = re.sub("
markdown_parser_core.py,"-+"", ""-"", s)\n        # Remove leading/trailing hyphens\n        s = s.strip(""-"")\n        base, i = s, 2\n        seen = getattr(self, ""_slug_seen"", set())\n        while s in seen:\n            s = "
markdown_parser_core.py,"\*\*([^*]+)\*\*"", "
markdown_parser_core.py,"\*([^*]+)\*"", "
markdown_parser_core.py,"__([^_]+)__"", "
markdown_parser_core.py,"_([^_]+)_"", "
markdown_parser_core.py,"\[([^\]]+)\]\([^)]+\)"", "
markdown_parser_core.py,"```[^`]*```"", """", text, flags=re.DOTALL)\n        text = re.sub("
content_context.py,"^\s*([`~])\1{2,}(\s*\S.*)?\s*$"", line)\n            if m:\n                ch = m.group(1)\n                # count the opening fence run length after leading spaces\n                run = re.match("
content_context.py,"^\s*([`~])\1{2,}(\s*\S.*)?\s*$"", line)\n                language = """"\n                if fence_match and fence_match.group(2):\n                    language = fence_match.group(2).strip()\n\n        "
sluggify_util.py,"[\s\t\n]+"", ""-"", text)\n    return re.sub("
,