# Evidence Directory Structure

**Purpose**: All task execution artifacts, logs, and verification data go here.

**Policy**: This directory is for runtime/execution evidence only. Do not commit to git (see `.gitignore`).

---

## Directory Structure

```
evidence/
├── logs/                    # Execution logs
│   ├── phase8_run_YYYYMMDD_HHMM.log
│   ├── rollback_1.2.log
│   └── ci_gate_run.log
├── results/                 # Task execution results (JSON)
│   ├── task_1.1.json
│   ├── task_1.2.json
│   └── task_2.1.json
├── hashes/                  # Render verification hashes
│   ├── yaml_sha256.txt
│   ├── json_sha256.txt
│   └── md_sha256.txt
└── artifacts/               # Task outputs
    ├── build_output.json
    ├── test_results.xml
    └── coverage_report.html
```

---

## File Retention Policy

| Directory | Retention | Purpose |
|-----------|-----------|---------|
| `logs/` | 30 days | Debugging, audit trail |
| `results/` | Until phase complete | Task status tracking |
| `hashes/` | Regenerate on render | Format synchronization verification |
| `artifacts/` | Permanent (archive after phase) | Task outputs, reports |

---

## Usage

### By AI Agents

AI agents write to this directory during task execution:

```python
# Write task result
from tools.emit_task_result import emit_result
emit_result("1.2", "success", "Tests passed", "", 0, 45.3, ["build/output.json"])

# Write logs
import logging
logging.basicConfig(filename='evidence/logs/phase8_run.log', level=logging.INFO)
```

### By CI

CI jobs write execution logs and test results:

```bash
# Run tests and capture results
pytest tests/ --junitxml=evidence/artifacts/test_results.xml

# Log CI gate execution
./tools/ci_gates.sh 2>&1 | tee evidence/logs/ci_gate_run.log
```

### By Humans

Review evidence for debugging or auditing:

```bash
# Check task execution status
cat evidence/results/task_1.2.json

# Review logs
tail -f evidence/logs/phase8_run.log

# Verify hashes match
diff <(cat evidence/hashes/yaml_sha256.txt) <(sha256sum DETAILED_TASK_LIST_template.yaml | awk '{print $1}')
```

---

## Auto-Generated Files

The following files are auto-generated by render_task_templates.py:

- `evidence/hashes/yaml_sha256.txt` - SHA256 of YAML source
- `evidence/hashes/json_sha256.txt` - SHA256 of JSON output
- `evidence/hashes/md_sha256.txt` - SHA256 of Markdown output

These ensure rendered files are synchronized with source.

---

## Cleanup

Evidence can be archived or deleted after phase completion:

```bash
# Archive evidence for phase 8
tar -czf evidence_phase8_$(date +%Y%m%d).tar.gz evidence/
mv evidence_phase8_*.tar.gz ../archived_evidence/

# Clean up (CAUTION: Deletes all evidence)
rm -rf evidence/logs/* evidence/results/* evidence/artifacts/*
```

---

## Schema Validation

Task results in `evidence/results/` can be validated against schema:

```bash
python -m jsonschema \
  -i evidence/results/task_1.2.json \
  schemas/task_result.schema.json
```

---

**Last Updated**: 2025-10-19
**Related**: `tools/emit_task_result.py`, `schemas/task_result.schema.json`
