{
  "metadata": {
    "mtime": 1765509487.3440514,
    "size": 6240,
    "path": "/home/lasse/Dropbox/python/omat/doxstrux/src/doxstrux/markdown/utils/section_utils.py",
    "version": "1.0"
  },
  "facts": {
    "code_truth": {
      "module_doc": "Section lookup utilities - O(log N) line-to-section mapping.\n\nPhase 8 (THREE_ADDITIONS.md) - Section Lookup Helper.\n\nThis module provides efficient lookup of which section contains a given line number.\nUses binary search for O(log N) lookup performance.\n\nInvariants (from THREE_ADDITIONS.md):\n- INV-2.1: section_of_line returns section where start_line <= line <= end_line\n- INV-2.2: Boundary lines (start_line, end_line) are included in section\n- INV-2.3: Lines in gaps between sections return None\n- INV-2.4: Negative lines and empty sections return None\n- INV-2.5: Single-line sections (start == end) correctly identified\n- INV-2.6: SectionIndex builds index once per instance (amortized)\n\nPreconditions (enforced by TestParserSectionInvariants):\n- Sections are sorted by start_line (ascending)\n- Sections have start_line and end_line fields (0-indexed)\n- Sections are non-overlapping\n\nFunctions:\n    section_of_line: Single lookup (convenience wrapper)\n\nClasses:\n    SectionIndex: Efficient repeated lookups with pre-built index",
      "functions": [
        {
          "name": "section_of_line",
          "args": [
            "sections",
            "line"
          ],
          "returns": "dict[str, Any] | None",
          "raises": [],
          "doc": "Find which section contains the given line number.\n\nConvenience wrapper for single lookups. For repeated lookups,\nuse SectionIndex instead for better performance.\n\nArgs:\n    sections: List of section dicts with start_line and end_line fields.\n              Must be sorted by start_line (ascending).\n    line: 0-indexed line number to look up.\n\nReturns:\n    The section dict containing the line, or None if:\n    - line is negative\n    - sections list is empty\n    - line falls in a gap between sections\n    - line is beyond all sections\n\nExamples:\n    >>> sections = [\n    ...     {\"id\": \"intro\", \"start_line\": 0, \"end_line\": 5},\n    ...     {\"id\": \"main\", \"start_line\": 6, \"end_line\": 15},\n    ... ]\n    >>> section_of_line(sections, 3)\n    {'id': 'intro', 'start_line': 0, 'end_line': 5}\n    >>> section_of_line(sections, 100)\n    None"
        }
      ],
      "classes": {
        "SectionIndex": [
          {
            "name": "__init__",
            "args": [
              "sections"
            ],
            "returns": "None",
            "raises": [],
            "doc": "Initialize index from sections list.\n\nBuilds the lookup index eagerly for consistent performance."
          },
          {
            "name": "_build_index",
            "args": [],
            "returns": "None",
            "raises": [],
            "doc": "Build the binary search index.\n\nInternal method - builds sorted list of start lines for binary search."
          },
          {
            "name": "get",
            "args": [
              "line"
            ],
            "returns": "dict[str, Any] | None",
            "raises": [],
            "doc": "Look up which section contains the given line.\n\nUses binary search for O(log N) performance.\n\nArgs:\n    line: 0-indexed line number to look up.\n\nReturns:\n    The section dict containing the line, or None if not found."
          },
          {
            "name": "__len__",
            "args": [],
            "returns": "int",
            "raises": [],
            "doc": "Return number of indexed sections."
          }
        ]
      }
    },
    "node_map": {
      "module": "Section lookup utilities - O(log N) line-to-section mapping.\n\nPhase 8 (THREE_ADDITIONS.md) - Section Lookup Helper.\n\nThis module provides efficient lookup of which section contains a given line number.\nUses binary search for O(log N) lookup performance.\n\nInvariants (from THREE_ADDITIONS.md):\n- INV-2.1: section_of_line returns section where start_line <= line <= end_line\n- INV-2.2: Boundary lines (start_line, end_line) are included in section\n- INV-2.3: Lines in gaps between sections return None\n- INV-2.4: Negative lines and empty sections return None\n- INV-2.5: Single-line sections (start == end) correctly identified\n- INV-2.6: SectionIndex builds index once per instance (amortized)\n\nPreconditions (enforced by TestParserSectionInvariants):\n- Sections are sorted by start_line (ascending)\n- Sections have start_line and end_line fields (0-indexed)\n- Sections are non-overlapping\n\nFunctions:\n    section_of_line: Single lookup (convenience wrapper)\n\nClasses:\n    SectionIndex: Efficient repeated lookups with pre-built index",
      "function:section_of_line": "Find which section contains the given line number.\n\nConvenience wrapper for single lookups. For repeated lookups,\nuse SectionIndex instead for better performance.\n\nArgs:\n    sections: List of section dicts with start_line and end_line fields.\n              Must be sorted by start_line (ascending).\n    line: 0-indexed line number to look up.\n\nReturns:\n    The section dict containing the line, or None if:\n    - line is negative\n    - sections list is empty\n    - line falls in a gap between sections\n    - line is beyond all sections\n\nExamples:\n    >>> sections = [\n    ...     {\"id\": \"intro\", \"start_line\": 0, \"end_line\": 5},\n    ...     {\"id\": \"main\", \"start_line\": 6, \"end_line\": 15},\n    ... ]\n    >>> section_of_line(sections, 3)\n    {'id': 'intro', 'start_line': 0, 'end_line': 5}\n    >>> section_of_line(sections, 100)\n    None",
      "class:SectionIndex": "Efficient section lookup with pre-built index.\n\nBuilds an internal index for O(log N) lookups via binary search.\nThe index is built once per instance (eager, in __init__).\n\nINV-2.6: Index is built at most once per instance.\n\nArgs:\n    sections: List of section dicts with start_line and end_line fields.\n              Must be sorted by start_line (ascending).\n\nExample:\n    >>> sections = [\n    ...     {\"id\": \"intro\", \"start_line\": 0, \"end_line\": 5},\n    ...     {\"id\": \"main\", \"start_line\": 6, \"end_line\": 15},\n    ... ]\n    >>> index = SectionIndex(sections)\n    >>> index.get(3)\n    {'id': 'intro', 'start_line': 0, 'end_line': 5}\n    >>> index.get(100)\n    None",
      "class:SectionIndex|method:__init__": "Initialize index from sections list.\n\nBuilds the lookup index eagerly for consistent performance.",
      "class:SectionIndex|method:_build_index": "Build the binary search index.\n\nInternal method - builds sorted list of start lines for binary search.",
      "class:SectionIndex|method:get": "Look up which section contains the given line.\n\nUses binary search for O(log N) performance.\n\nArgs:\n    line: 0-indexed line number to look up.\n\nReturns:\n    The section dict containing the line, or None if not found.",
      "class:SectionIndex|method:__len__": "Return number of indexed sections."
    },
    "presence": {
      "module": true,
      "function:section_of_line": true,
      "class:SectionIndex": true,
      "class:SectionIndex|method:__init__": false,
      "class:SectionIndex|method:_build_index": true,
      "class:SectionIndex|method:get": true,
      "class:SectionIndex|method:__len__": false
    },
    "fingerprint": {
      "file": "/home/lasse/Dropbox/python/omat/doxstrux/src/doxstrux/markdown/utils/section_utils.py",
      "fingerprint": "dec221d6d00795d463750d4446f1374248e330b268f477ee1c4cf59cffaed6c5",
      "timestamp": "2025-12-17T03:56:26.039903Z",
      "entity_count": 7,
      "documented_count": 7,
      "entities": [
        "class:SectionIndex",
        "class:SectionIndex|method:__init__",
        "class:SectionIndex|method:__len__",
        "class:SectionIndex|method:_build_index",
        "class:SectionIndex|method:get",
        "function:section_of_line",
        "module"
      ]
    },
    "requirements": [],
    "semantic_tags": {},
    "behavior_contracts": {},
    "semantic_summary": {
      "total_entities": 0,
      "tag_distribution": {},
      "pure_function_count": 0,
      "pure_function_pct": 0,
      "idempotent_count": 0,
      "thread_safe_count": 0,
      "mutation_count": 0,
      "blocking_count": 0,
      "most_common_tags": []
    }
  }
}